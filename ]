#include "LuaHandler.h"
#include <iostream>
#include <vector.h>

LuaHandler::LuaHandler(const char *lua_path) {
  luaL_openlibs(lua_state_);
  luaL_loadfile(lua_state_, lua_path);
};

LuaHandler::~LuaHandler() { lua_close(lua_state_); };

bool LuaHandler::executeLua() {
  if (lua_pcall(lua_state_, 0, 0, 0) != 0) {
    // success
    // WARNING:　実際にオブジェクトを自身で削除できるか不明
    delete this;
    return true;
  }
  return false;
}

template <typename T>
void LuaHandler::setFunctionsForLua(const char *library_name, T *mylib) {
  luaL_newlib(lua_state_, mylib);
  lua_setglobal(lua_state_, library_name);
}
